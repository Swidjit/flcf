.row

  .large-6.small-12.columns
    .panel
      %h4 Get in touch!
      .row
        .large-7.columns
          %p Comments, questions, problems or ideas?  Send us an email!
        .large-5.columns
          %a.radius.button.right{:href => "#"} Contact Us
  .large-6.small-12.columns
    .panel
      %h4 Spread the word!
      .row
        .large-12.columns
          %p Help us grow the FLCF by sharing on your social networks
          %a.twitter-share-button{"data-count" => "none", "data-hashtags" => "fingerlakes", "data-text" => "Offset your carbon locally", "data-url" => "http://fingerlakesclimatefund.org", "data-via" => "FingerLakesClimateFund", :href => "https://twitter.com/share"} Tweet
          .fb-like{"data-share" => "true", "data-show-faces" => "true", "data-width" => "450"}


%footer.row

  .large-12.columns
    .row
      .large-6.columns
        -if user_signed_in?
          %li
            = link_to "Log out", destroy_session_path(:user), :method => :delete

        -else
          %li
            =link_to  new_user_registration_path, :class=>'button header-button' do
              Register
        %p Â© Sustainable Tompkins
      .large-6.columns
        %p Carbon offsets are deductible through Social Ventures 501(c)3
#myModal.reveal-modal{"data-reveal" => ""}
  %h2 OK, ready for checkout.
  %p Just a quick question first:  Would you like to proceed as a guest, or login to your FLCF account.  Using a FLCF account will allow you to save and reuse your offsets.
  %button.checkout-without-login checkout as guest
  %button.show-login create account before checkout
  %a.close-reveal-modal Ã—


:javascript
  $('.show-login').on("click", function() {
    $("#myModal").html("#{j render :partial => 'devise/sessions/login'}")
  });


-if current_user

  #login-status{:value=>current_user.email}
  #user-offsets.reveal-modal{"data-reveal" => ""}
    %h3 Your account has been created
    %p Ok, let's get back to offsetting you carbon use.
    =render :partial => 'offsets/offset', :collection => current_user.offsets.where(:purchased=>:false), :as => :offset
    = form_tag charges_path, id: 'chargeForm' do
      %script{:src => "https://checkout.stripe.com/checkout.js"}
      = hidden_field_tag 'stripeToken'
      = hidden_field_tag 'stripeEmail'
      %button#customButton.btn.btn-large.btn-primary Buy Now
      :javascript
        var key = '#{j Rails.configuration.stripe[:publishable_key]}';

        var handler = StripeCheckout.configure({
          key: key,
          token: function(token, args) {
                document.getElementById("stripeToken").value = token.id;
                document.getElementById("stripeEmail").value = token.email;
                document.getElementById("chargeForm").submit();
              }
          });

        document.getElementById('customButton').addEventListener('click', function(e) {
          total_cost = 0;
          $('#cart .cost').each(function() {
            total_cost += parseFloat($(this).text());
            console.log($(this).text());

          });
          cost = parseInt(total_cost*100);
          console.log("t:"+total_cost);
          console.log(cost);
          handler.open({
            name: 'Finger Lakes Climate Fund',
            description: 'Carbon Offset ($'+total_cost+')',
            amount: cost,
            shippingAddress: false
          });
          e.preventDefault();
        });
-else
  #login-status{:value=>"guest"}
